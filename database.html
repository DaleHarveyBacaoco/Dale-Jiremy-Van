
<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>Simple HTML "Database" — LocalStorage demo</title>
		<style>
			body { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial; max-width:980px; margin:24px auto; color:#111 }
			header { display:flex; align-items:center; justify-content:space-between }
			h1 { font-size:20px; margin:0 }
			.controls { display:flex; gap:8px; align-items:center }
			.card { border:1px solid #eee; padding:16px; border-radius:8px; margin-top:16px; box-shadow:0 1px 0 rgba(0,0,0,.03) }
			table { width:100%; border-collapse:collapse }
			thead th { text-align:left; font-size:12px; color:#555; border-bottom:1px solid #eee; padding:8px }
			tbody td { padding:8px; border-bottom:1px solid #fafafa }
			form { display:flex; gap:8px; align-items:center; flex-wrap:wrap }
			input[type=text], input[type=number] { padding:6px 8px; border:1px solid #ddd; border-radius:6px }
			button { background:#0b5fff; color:white; border:0; padding:8px 10px; border-radius:6px; cursor:pointer }
			button.ghost { background:transparent; color:#0b5fff; border:1px solid #0b5fff }
			button.danger { background:#ff4d4f }
			.muted { color:#666; font-size:13px }
			.small { font-size:12px; padding:6px 8px }
			.flex { display:flex; gap:8px; align-items:center }
			.grow { flex:1 }
			.notice { background:#f6ffed; border:1px solid #d7ffd6; padding:8px 10px; border-radius:6px; color:#2a7a29 }
			.actions { display:flex; gap:6px }
		</style>
	</head>
	<body>
		<header>
			<h1>Simple HTML "Database" — LocalStorage demo</h1>
			<div class="controls">
				<small class="muted">No server required — everything runs in your browser.</small>
			</div>
		</header>

		<section class="card">
			<div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
				<div>
					<strong>Records</strong>
					<div class="muted">A tiny client-side database built with LocalStorage (CRUD + seed data + JSON import/export).</div>
				</div>
				<div class="flex">
					<button id="seedBtn" class="small ghost">Seed sample data</button>
					<button id="clearBtn" class="small danger">Clear all</button>
					<button id="exportBtn" class="small">Export JSON</button>
					<input id="importFile" type="file" accept="application/json" style="display:none" />
					<button id="importBtn" class="small ghost">Import JSON</button>
				</div>
			</div>

			<div style="margin-top:12px;display:flex;gap:12px;align-items:center">
				<input id="search" class="grow" type="text" placeholder="Search by name, email or notes" />
				<select id="sortBy">
					<option value="id">Sort: id (asc)</option>
					<option value="nameAsc">Sort: name ↑</option>
					<option value="nameDesc">Sort: name ↓</option>
				</select>
			</div>

			<div style="margin-top:12px; overflow:auto;">
				<table aria-label="records table">
					<thead>
						<tr>
							<th style="width:55px">#</th>
							<th>Name</th>
							<th>Email</th>
							<th style="width:110px">Amount</th>
							<th>Notes</th>
							<th style="width:170px">Actions</th>
						</tr>
					</thead>
					<tbody id="rows"></tbody>
				</table>
			</div>

			<div style="margin-top:16px; border-top:1px dashed #eee; padding-top:12px">
				<strong>Add / Edit record</strong>
				<form id="form" onsubmit="return false" style="margin-top:8px">
					<input id="id" type="hidden" />
					<input id="name" type="text" placeholder="Full name" required />
					<input id="email" type="text" placeholder="Email" required />
					<input id="amount" type="number" step="0.01" placeholder="Amount" />
					<input id="notes" type="text" placeholder="Short notes" class="grow" />
					<div class="actions">
						<button id="saveBtn">Save</button>
						<button id="cancelBtn" class="ghost" type="button">Reset</button>
					</div>
				</form>
			</div>

			<div style="margin-top:12px" id="status"></div>
		</section>

		<section class="card" style="margin-top:18px">
			<strong>How this works</strong>
			<ol style="margin-top:6px">
				<li>Records are stored in LocalStorage under the key <code>sampleDB</code>.</li>
				<li>Use <strong>Seed sample data</strong> to quickly add 5 records. You can then create, update or delete records.</li>
			</ol>
			<div class="muted" style="margin-top:8px">This page is intentionally small and dependency‑free so you can use it as a starting point to learn about simple client-side persistence.</div>
		</section>

		<script>
			// Simple client-side "database" helper using LocalStorage
			const DB_KEY = 'sampleDB'

			function readDB() {
				try {
					const raw = localStorage.getItem(DB_KEY) || '[]'
					return JSON.parse(raw)
				} catch (e) { console.error(e); return [] }
			}

			function writeDB(arr) { localStorage.setItem(DB_KEY, JSON.stringify(arr, null, 2)) }

			function nextId(items) { return items.reduce((m, it) => Math.max(m, it.id||0), 0) + 1 }

			// CRUD operations
			function createRecord(rec) {
				const items = readDB()
				rec.id = nextId(items)
				items.push(rec)
				writeDB(items)
				return rec
			}

			function updateRecord(id, fields) {
				const items = readDB()
				const i = items.findIndex(x => x.id === id)
				if (i === -1) return null
				items[i] = Object.assign({}, items[i], fields)
				writeDB(items)
				return items[i]
			}

			function deleteRecord(id) {
				let items = readDB()
				const before = items.length
				items = items.filter(x => x.id !== id)
				writeDB(items)
				return items.length !== before
			}

			function clearDB() { writeDB([]) }

			// UI helpers
			const rowsEl = document.getElementById('rows')
			const statusEl = document.getElementById('status')
			const form = document.getElementById('form')
			const seedBtn = document.getElementById('seedBtn')
			const clearBtn = document.getElementById('clearBtn')
			const search = document.getElementById('search')
			const sortBy = document.getElementById('sortBy')
			const exportBtn = document.getElementById('exportBtn')
			const importBtn = document.getElementById('importBtn')
			const importFile = document.getElementById('importFile')

			function notify(msg, ok=true) {
				statusEl.innerHTML = `<div class="notice">${msg}</div>`
				setTimeout(() => { if (statusEl.innerHTML) statusEl.innerHTML = '' }, 2500)
			}

			function renderTable() {
				const q = (search.value || '').toLowerCase()
				let items = readDB()
				if (q) items = items.filter(it => [it.name, it.email, it.notes].join(' ').toLowerCase().includes(q))
				// sort
				if (sortBy.value === 'nameAsc') items.sort((a,b)=>a.name.localeCompare(b.name))
				if (sortBy.value === 'nameDesc') items.sort((a,b)=>b.name.localeCompare(a.name))
				if (sortBy.value === 'id') items.sort((a,b)=>a.id - b.id)

				if (items.length === 0) {
					rowsEl.innerHTML = '<tr><td colspan="6" class="muted">No records — try seeding sample data or adding a record below.</td></tr>'
					return
				}

				rowsEl.innerHTML = items.map(it => `
					<tr data-id="${it.id}">
						<td>${it.id}</td>
						<td>${escapeHtml(it.name)}</td>
						<td><a href="mailto:${escapeHtml(it.email)}">${escapeHtml(it.email)}</a></td>
						<td>${Number(it.amount||0).toFixed(2)}</td>
						<td>${escapeHtml(it.notes||'')}</td>
						<td>
							<div class="actions">
								<button onclick="editRecord(${it.id})" class="small ghost">Edit</button>
								<button onclick="removeRecord(${it.id})" class="small danger">Delete</button>
							</div>
						</td>
					</tr>
				`).join('\n')
			}

			// quick HTML escape
			function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') }

			function editRecord(id) {
				const items = readDB()
				const it = items.find(x => x.id === id)
				if (!it) return notify('Record not found', false)
				document.getElementById('id').value = it.id
				document.getElementById('name').value = it.name
				document.getElementById('email').value = it.email
				document.getElementById('amount').value = it.amount
				document.getElementById('notes').value = it.notes
				window.scrollTo({ top: document.body.scrollHeight, behavior:'smooth' })
			}

			function removeRecord(id) {
				if (!confirm('Delete record #' + id + '?')) return
				deleteRecord(id)
				renderTable()
				notify('Record removed')
			}

			// form actions
			document.getElementById('saveBtn').addEventListener('click', () => {
				const id = Number(document.getElementById('id').value || 0)
				const name = document.getElementById('name').value.trim()
				const email = document.getElementById('email').value.trim()
				const amount = Number(document.getElementById('amount').value || 0)
				const notes = document.getElementById('notes').value.trim()
				if (!name || !email) return notify('Name and email are required', false)
				if (id === 0) {
					createRecord({ name, email, amount, notes })
					notify('Record added')
				} else {
					updateRecord(id, { name, email, amount, notes })
					notify('Record updated')
				}
				form.reset(); document.getElementById('id').value = ''
				renderTable()
			})

			document.getElementById('cancelBtn').addEventListener('click', () => { form.reset(); document.getElementById('id').value = '' })

			// seed sample data
			seedBtn.addEventListener('click', () => {
				const sample = [
					{ name: 'Avelin Dale', email: 'adel@example.com', amount: 123.45, notes: 'Long-time customer' },
					{ name: 'Jeremy Van', email: 'jeremy@example.com', amount: 9.99, notes: 'One-off purchase' },
					{ name: 'Maya Priet', email: 'maya@example.com', amount: 250.0, notes: 'VIP' },
					{ name: 'Rico B', email: 'rico@example.com', amount: 5.0, notes: 'Test account' },
					{ name: 'Sam P', email: 'sam@example.com', amount: 75.25, notes: 'Return customer' }
				]
				const items = readDB()
				// don't reseed when there is content already
				if (items.length) {
					if (!confirm('The database already contains records. Continue and append sample data?')) return
				}
				sample.forEach(s => createRecord(s))
				renderTable()
				notify('Sample data seeded')
			})

			clearBtn.addEventListener('click', () => {
				if (!confirm('Clear all records from LocalStorage?')) return
				clearDB(); renderTable(); notify('Database cleared')
			})

			// search / sort
			search.addEventListener('input', () => renderTable())
			sortBy.addEventListener('change', () => renderTable())

			// JSON export/import
			exportBtn.addEventListener('click', () => {
				const data = readDB()
				const content = JSON.stringify(data, null, 2)
				const blob = new Blob([content], { type: 'application/json' })
				const url = URL.createObjectURL(blob)
				const a = document.createElement('a')
				a.href = url; a.download = 'sample-db.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url)
			})

			importBtn.addEventListener('click', () => importFile.click())
			importFile.addEventListener('change', async (e) => {
				const file = e.target.files[0]
				if (!file) return
				try {
					const text = await file.text()
					const parsed = JSON.parse(text)
					if (!Array.isArray(parsed)) throw new Error('Invalid JSON — expected array of records')
					// If items include id fields, we'll treat them as actual records and append.
					const existing = readDB()
					parsed.forEach(item => {
						// If id present, keep it, but ensure we don't clash with existing; simpler: append and normalize id later
						if (item.id) delete item.id
						createRecord(item)
					})
					renderTable()
					notify('JSON imported (appended)')
				} catch (err) {
					notify('Import failed: ' + (err.message || err), false)
				}
				importFile.value = ''
			})

			// initialize & render
			renderTable()

			// expose a couple functions to the page so inline onclick handlers will work
			window.editRecord = editRecord
			window.removeRecord = removeRecord

		</script>
	</body>
</html>
